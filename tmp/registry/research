# https://admx.help/
# Disable Telemetry for Default User 
Write-Host "[REG] Disabling Telemetry for Default User" -ForegroundColor Cyan

# Set-ItemProperty for Default User (HKEY_USERS\.Default)
$defaultUserPath = "Registry::HKEY_USERS\.Default\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection"
Set-ItemProperty -Path $defaultUserPath -Name "AllowTelemetry" -Type DWord -Value 0

# Additional paths if needed
$additionalPaths = @(
    "HKLM:\SOFTWARE\Policies\Microsoft\Windows\DataCollection",
    "HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Policies\DataCollection"
)

foreach ($path in $additionalPaths) {
    Set-ItemProperty -Path $path -Name "AllowTelemetry" -Type DWord -Value 0
}

Example 1: Remove a context menu entry from File Explorer

Windows Registry Editor Version 5.00

; Remove a context menu entry (replace {GUID} with the actual GUID)
[-HKEY_CLASSES_ROOT\Directory\shellex\ContextMenuHandlers\{GUID}]
Example 2: Remove a context menu entry from Desktop


Windows Registry Editor Version 5.00

; Remove a context menu entry from the Desktop (replace {GUID} with the actual GUID)
[-HKEY_CLASSES_ROOT\DesktopBackground\ShellEx\ContextMenuHandlers\{GUID}]
Example 3: Remove a column handler from File Explorer details view


Windows Registry Editor Version 5.00

; Remove a column handler (replace {GUID} with the actual GUID)
[-HKEY_CLASSES_ROOT\SystemFileAssociations\{GUID}]
Example 4: Remove a thumbnail handler


Windows Registry Editor Version 5.00

; Remove a thumbnail handler (replace {GUID} with the actual GUID)
[-HKEY_CLASSES_ROOT\*\shellex\{BB2E617C-0920-11d1-9A0B-00C04FC2D6C1}]
Replace {GUID} with the actual GUID of the shell extension you want to remove.
