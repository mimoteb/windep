@echo off

echo this script requires an internet connection.
echo written by Solomon Samuel

echo creating base directory in %temp%\dep
mkdir %temp%\dep

echo Downloading automate.ps1 script from Mimoteb's Repo...

REM GitHub raw content URL for the PS1 file
set GitHubRawURL="https://raw.githubusercontent.com/mimoteb/win/main/online/automate.ps1?$RANDOM"

REM Path to save the downloaded PS1 file
set PS1FilePath=%TEMP%\dep\automate.ps1

REM Delete existing file if it exists
del /q "%PS1FilePath%"

REM Download the PS1 file
curl -o %PS1FilePath% %GitHubRawURL%
if %errorlevel% neq 0 (
    echo Error: Failed to download the PS1 file.
    exit /b %errorlevel%
)

REM Execute the downloaded PS1 file
powershell -ExecutionPolicy Bypass -File %PS1FilePath%
if %errorlevel% neq 0 (
    echo Error: Automate.ps1 script execution failed.
) else (
    echo Automate.ps1 Script finished executing successfully.
)

REM Pause to keep the CMD window open
pause